<!doctype html>
<html class="x-admin-sm">
    <head>
        <meta charset="UTF-8">
        <meta name="renderer" content="webkit|ie-comp|ie-stand">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
        <meta http-equiv="Cache-Control" content="no-siteapp" />
		<script src="../lib/layui/layui.js" charset="utf-8"></script>
        <link rel="stylesheet" href="../css/font.css">
        <link rel="stylesheet" href="../css/index.css">
		<script type="text/javascript" src="./js/base.js"></script>
    </head>

    <body>
		<!--delprint1-->
		<br>
		<div class="layui-row layui-col-space5">
			<div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
				<button class="layui-btn layui-btn-fluid"  type="button" onclick="doPrint()">
					打印
				</button>
			</div>
			<div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
			</div>
			<div class="layui-col-xs4 layui-col-sm4 layui-col-md4">
			</div>
		</div>
		<br>
		<!--delprint2-->
		<!--startprint-->
		<style>
			.borderSet {
				border:1px solid #000000;
				text-align:center;
			}
			.borderSetLeftAlign {
				border:1px solid #000000;
				text-align:left;
			}
			.borderSetLeftTopAlign {
				border:1px solid #000000;
				text-align:left;
				vertical-align:top;
			}
			.titleSet {
				text-align:center;
				font-size: 30px;
				font-weight: bold;
			}
			.indexSet {
				text-align:right;
				font-size: 15px;
			}
		</style>
		<div id="printdiv">
		</div>
        <!--endprint-->
		
		
		
		<script id="printContent" type="text/html">
			<table width="795" border="0" cellpadding="0" cellspacing="0" style="page-break-after:always">
				<col width="123.00"/>
				<col width="68"/>
				<col width="36.00"/>
				<col width="72.00"/>
				<col width="26"/>
				<col width="65"/>
				<col width="19"/>
				<col width="63.00"/>
				<col width="55"/>
				<col width="115"/>
				<col width="153"/>
				<col width="81"/>
				<tr height="30.00">
					<td height="30.00" width="795" colspan="11" class="indexSet">No:{{= d.Idx}}</td>
				</tr>
				<tr height="51.00">
					<td height="51.00" width="795" colspan="11" class="titleSet">居家和社区养老服务对象登记表</td>
				</tr>
				<tr height="38.33">
					<td class="xl67" height="38.33" colspan="11"></td>
				</tr>
				<tr height="35" class='borderSet'>
					<td height="35" class='borderSet layui-font-16'>姓名</td>
					<td colspan="2" class='borderSet layui-font-16'>{{= d.Name}}</td>
					<td colspan="2" class='borderSet layui-font-16'>性别</td>
					<td colspan="2" class='borderSet layui-font-16'>{{= d.Sex || ""}}</td>
					<td colspan="2" class='borderSet layui-font-16'>年龄</td>
					<td class='borderSet  layui-font-16'>{{= d.Age || ""}}</td>
					{{# if(d.AvatarPath == "") { }}
					<td rowspan="5" class='borderSet  layui-font-16'>照<br/>片</td>
					{{#  } else { }}
					<td rowspan="5" class='borderSet  layui-font-16'>
						<img src={{ d.AvatarPath }} style="height:164px;width:118px" id="demo1">
					</td>
					{{#  } }}
				</tr>
				<tr height="35" class='borderSet'>
					<td height="35"  class='borderSet layui-font-16'>身份证号</td>
					<td colspan="4"  class='borderSetLeftAlign layui-font-16'>
						&nbsp;&nbsp;&nbsp;&nbsp;{{= d.ChinaId || ""}}
					</td>
					<td colspan="2" class='borderSet layui-font-16'>联系电话</td>
					<td colspan="3" class='borderSet layui-font-16'>{{= d.Phone || ""}}</td>
				</tr>
				<tr height="35" class='borderSet layui-font-16'>
					<td height="35" rowspan="3" class='borderSet layui-font-16'>家庭住址</td>
					<td colspan="9" rowspan="3" class='borderSetLeftAlign layui-font-16'>
						&nbsp;&nbsp;&nbsp;&nbsp;{{= d.Addr || ""}}
					</td>
				</tr>
				<tr height="35" ></tr>
				<tr height="35" ></tr>
				<tr height="35" class='borderSet layui-font-16'>
					<td height="175" rowspan="5" class='borderSet layui-font-16'>紧急联系人</td>
					{{# if(typeof d.ContactData[0]==='undefined'){ }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'></td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'></td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'></td>
					{{#  } else { }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'>{{= d.ContactData[0].name }}</td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'>{{= d.ContactData[0].phone }}</td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'>{{= d.ContactData[0].relationship }}</td>
					{{#  } }} 
				</tr>
				<tr height="35" class='borderSet layui-font-16'>
					{{# if(typeof d.ContactData[1]==='undefined'){ }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'></td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'></td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'></td>
					{{#  } else { }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'>{{= d.ContactData[1].name }}</td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'>{{= d.ContactData[1].phone }}</td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'>{{= d.ContactData[1].relationship }}</td>
					{{#  } }} 
				</tr>
				<tr height="35" class='borderSet layui-font-16'>
					{{# if(typeof d.ContactData[2]==='undefined'){ }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'></td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'></td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'></td>
					{{#  } else { }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'>{{= d.ContactData[2].name }}</td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'>{{= d.ContactData[2].phone }}</td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'>{{= d.ContactData[2].relationship }}</td>
					{{#  } }} 
				</tr>
				<tr height="35" class='borderSet layui-font-16'>
					{{# if(typeof d.ContactData[3]==='undefined'){ }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'></td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'></td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'></td>
					{{#  } else { }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'>{{= d.ContactData[3].name }}</td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'>{{= d.ContactData[3].phone }}</td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'>{{= d.ContactData[3].relationship }}</td>
					{{#  } }} 
				</tr>
				<tr height="35" class='borderSet layui-font-16'>
					{{# if(typeof d.ContactData[4]==='undefined'){ }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'></td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'></td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'></td>
					{{#  } else { }}
						<td class='borderSet layui-font-16'>姓名</td>
						<td colspan="2" class='borderSet layui-font-16'>{{= d.ContactData[4].name }}</td>
						<td colspan="2" class='borderSet layui-font-16'>电话</td>
						<td colspan="3" class='borderSet layui-font-16'>{{= d.ContactData[4].phone }}</td>
						<td class='borderSet layui-font-16'>关系</td>
						<td class='borderSet layui-font-16'>{{= d.ContactData[4].relationship }}</td>
					{{#  } }} 
				</tr>
				
				
				<tr height="35" class='borderSet layui-font-16'>
					<td height="385" rowspan="11" class='borderSet layui-font-16'>健康情况</td>
					<td rowspan="4" class='borderSet layui-font-16'>慢病</td>
					<td colspan="9" rowspan="4" class='borderSetLeftAlign layui-font-16'>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("高血压") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("高血压") != -1){ }}<b>高血压</b>{{#  } else { }}高血压{{#  } }}
						</font>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("高血糖") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("高血糖") != -1){ }}<b>高血糖</b>{{#  } else { }}高血糖{{#  } }} 
						</font>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("冠心病") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("冠心病") != -1){ }}<b>冠心病</b>{{#  } else { }}冠心病{{#  } }} 
						</font>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性支气管炎") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性支气管炎") != -1){ }}<b>慢性支气管炎</b>{{#  } else { }}慢性支气管炎{{#  } }} 
						</font>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("哮喘") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("哮喘") != -1){ }}<b>哮喘</b>{{#  } else { }}哮喘{{#  } }} 
						</font>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性肝炎") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性肝炎") != -1){ }}<b>慢性肝炎</b>{{#  } else { }}慢性肝炎{{#  } }} 
						</font>
						</br>
						</br>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性贫血") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性贫血") != -1){ }}<b>慢性贫血</b>{{#  } else { }}慢性贫血{{#  } }} 
						</font>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性关节炎") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性关节炎") != -1){ }}<b>慢性关节炎</b>{{#  } else { }}慢性关节炎{{#  } }} 
						</font>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性颈椎疼痛") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("慢性颈椎疼痛") != -1){ }}<b>慢性颈椎疼痛</b>{{#  } else { }}慢性颈椎疼痛{{#  } }} 
						</font>
						<span class="layui-font-16">&nbsp; </span>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("痛风") != -1){ }}☑{{#  } else { }}□{{#  } }} 
						</font>
						<font class="layui-font-16">
							{{# if(d.SlowIll.indexOf("痛风") != -1){ }}<b>痛风</b>{{#  } else { }}痛风{{#  } }} 
						</font>	
					</td>
				</tr>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'>
					<td rowspan="7" class='borderSet layui-font-16'>其他</td>
					<td colspan="9" rowspan="7" class='borderSetLeftTopAlign layui-font-16'>
						</br><span class="layui-font-16">&nbsp;&nbsp;&nbsp;&nbsp;</span>
						{{= d.Healthy}}
					</td>
				</tr>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'>
				<td height="210" rowspan="6" class='borderSet layui-font-16'>备注</td>
				<td colspan="10" rowspan="6" class='borderSetLeftTopAlign layui-font-16'>
					</br><span class="layui-font-16">&nbsp;&nbsp;&nbsp;&nbsp;</span>
					{{= d.Remarks }}
				</td>
				</tr>	
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'/>
				<tr height="35" class='borderSet layui-font-16'>
					<td height="35"  class='borderSet layui-font-16'>登记人</td>
					<td colspan="5"  class='borderSet layui-font-16'>{{= d.Handler }}</td>
					<td colspan="3"  class='borderSet layui-font-16'>登记日期</td>
					<td colspan="2"  class='borderSet layui-font-16'>{{= d.RegisterTime }}</td>
				</tr>
			</table>
		</script>
    </body>
	
	<script>
		layui.use("laytpl", function(){
			var laytpl = layui.laytpl;
			
			client = layui.sessionData("ees-client-list")["detail"];
			client["ContactData"] = JSON.parse(JSON.parse(client.Contacts))
			client["AvatarPath"] = ""
			console.log(client["Avatar"])
			if (client.Avatar !== "") {
				client["AvatarPath"] = 	BasePath + "/avatarphoto/" + client.Avatar + ".jpg"
			}
			var printtpl = printContent.innerHTML;
			var printdiv = document.getElementById("printdiv");
			laytpl(printtpl).render(client, function(html){
				printdiv.innerHTML = html;
			})
		})
	
		function doPrint() {
			/*
			const html = window.document.body.innerHTML; 
			const start = "<!--startprint-->"; //开始打印标识字符串有17个字符
			const end = "<!--endprint-->"; //结束打印标识字符串
			let printHtml = html.substring(html.indexOf(start) + 17); //从开始打印标识之后的内容
			printHtml = printHtml.substring(0, printHtml.indexOf(end)); //截取开始标识和结束标识之间的内容
			window.document.body.innerHTML = printHtml; //把需要打印的指定内容赋给body.innerHTML
			window.print(); //调用浏览器的打印功能打印指定区域
			window.document.body.innerHTML = html;//重新给页面内容赋值
			*/
			
			client = layui.sessionData("ees-client-list")["detail"];
			let ary = [client];
			console.log(ary)
			layui.sessionData("ees-client-list", {key:"print", value:ary})
		
			layer.open({
				type: 2,
				area: ['1px', '1px'],
				offset: ['-100px', '-100px'],
				fixed: false, //不固定
				maxmin: true,
				title: "打印",
				content: 'client-print.html',
			});
		}
	</script>
</html>